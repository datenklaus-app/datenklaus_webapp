{% extends "base.html" %}
{% block content %}
    {% load static %}
    <div class="container text-center">
        <div class="row justify-content-center">
            <div class="col-md-6">
                <h1>Raum <span style="color:blue">{{ room_name }}</span></h1>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-md-6">
                <h3>Aktives Modul</h3>
                <a href="#" class="list-group-item list-group-item-action flex-column align-items-start active">
                    <div class="d-flex w-100 justify-content-center">
                        <h5 class="mb-1">{% if active_module %} {{ active_module }} {% else %} Kein Modul
                            ausgewählt{% endif %}
                        </h5>
                    </div>
                </a>
            </div>
            <div class="col-md-6">
                <h3>Verbundene Schüler*innen</h3>
                <div class="row justify-content-center">
                    <div class="col-md-6">
                        <div class="row justify-content-center">
                            <div class="list-group overflow-auto" id="students">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block handlebars-template %}
    {% verbatim %}
    <a href="#" class="list-group-item list-group-item-action flex-column align-items-start active">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">{{ name }}</h5>
            <small> {{ expiry }}</small>
        </div>
        <p class="mb-1"></p>
        <h6 class="mb-1">{{ progress }}</h6>
        <p class="mb-1"></p>
        <small>ID: {{ session }}</small>
    </a>
    {% endverbatim %}
{% endblock %}
{% block scripts %}
    <script>
        function update() {
            $.ajax({
                method: "POST",
                url: "",
                dataType: 'json',
                contentType: 'json',
                headers: {
                    "X-CSRFToken": "{{ csrf_token }}"
                },
                success: function (data) {
                    const $el = $("#students");
                    $el.empty(); // remove old options
                    console.log(data)
                    const source = document.getElementById("student-status-template").innerHTML;
                    const template = Handlebars.compile(source);

                    $.each(data.students, function (index, value) {
                        const htmlOutput = template(value);
                        $el.append(htmlOutput)
                    });
                }
            })
        };
        setInterval(update, 2000)
    </script>
{% endblock %}

</body>
</html>
